<!DOCTYPE html>

<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1" />

		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
		<link href="lib/swipebox.min.css" rel="stylesheet" />

		<script src="http://code.jquery.com/jquery-2.2.4.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
		<script src="lib/jquery.swipebox.min.js"></script>

		<script>
			var server = 'http://localhost:8080';
			var user = 'test@liferay.com';
			var password = 'test';

			function createGroupListItemFolder(field) {
				var listItem = _createGroupList(field.nameCurrentValue, field.friendlyURL, 'ui-li-aside');

				return listItem;
			}

			function createListItemImage(link, title) {
				var anchorImage = $(document.createElement('a'));

				anchorImage.addClass('swipebox');
				anchorImage.attr('href', link);
				anchorImage.attr('title', title);

				var image = $(document.createElement('img'));
				image.attr('src', link);
				image.attr('alt', 'image');

				anchorImage.append(image);

				var listItem = _createGroupListItem(title, anchorImage, 'ui-li-icon');

				return listItem;
			}

			function _createGroupListItem(headerTitle, content, jqueryMobileCSSClass) {
				var listItem = $(document.createElement('li'));
				var anchor = $(document.createElement('a'));

				anchor.attr('href', '#');

				var header = $(document.createElement('h2'));

				header.html(headerTitle);

				anchor.append(header);

				var aside = $(document.createElement('p'));

				aside.addClass(jqueryMobileCSSClass);
				aside.html(content);

				anchor.append(aside);

				listItem.append(anchor);

				return listItem;
			}

			$(document).ready(
				function() {
					$.get(
						{
							type: "GET",
							url: server + '/api/jsonws/group/get-user-sites-groups',
							beforeSend: function (xhr){
								xhr.setRequestHeader('Authorization', 'Basic ' + btoa(user + ":" + password));
							}
						},
						function(data, status) {
							var groups = $('#groups');
							$.each(
								data,
								function(i, field) {
									groups.append(createGroupListItem(field));
									console.log(field);
								}
							);

							groups.listview('refresh');
						}
					);
				}
			);

			function test() {
				var groups = $('#groups');

				groups.append(createListItemImage("https://github.com/enochchu/stupidfunpictures/raw/master/gif/makeitrain/monopoly.gif","makeitrain"));

				groups.append(createListItemImage("https://raw.githubusercontent.com/enochchu/stupidfunpictures/master/gif/rambo/rambomode.jpg","rambo"));

				groups.append(createListItemImage("https://raw.githubusercontent.com/enochchu/stupidfunpictures/master/gif/disappear/danger5window.gif","makeitrain"));
			}
		</script>
	</head>
	<body>
		<div data-role="page">
			<div data-role="header">
				<h1>LR Image Gallery</h1>
			</div>

			<div role="main" class="ui-content">
				<ul data-inset="true" data-role="listview" id="groups">
				</ul>
			</div>

			<div data-role="footer">
				<h4>Footer</h4>
			</div>
		</div>
	</body>
</html>
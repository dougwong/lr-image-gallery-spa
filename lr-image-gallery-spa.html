<!DOCTYPE html>

<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1" />

		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
		<link href="lib/swipebox.min.css" rel="stylesheet" />

		<script src="http://code.jquery.com/jquery-2.2.4.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
		<script src="lib/jquery.swipebox.min.js"></script>

		<script>
			var server = 'http://localhost:8080';
			var user = 'test@liferay.com';
			var password = 'test';

			function createGroupListItem(field) {
				var listItem = $(document.createElement('li'));
				var anchor = $(document.createElement('a'));

				anchor.attr('href', '#');

				var header = $(document.createElement('h2'));

				header.html(field.nameCurrentValue);

				anchor.append(header);

				var aside = $(document.createElement('p'));

				aside.addClass('ui-li-aside');
				aside.html(field.friendlyURL);

				anchor.append(aside);

				listItem.append(anchor);

				return listItem;
			}

			$(document).ready(
				function() {
					$.get(
						{
							type: "GET",
							url: server + '/api/jsonws/group/get-user-sites-groups',
							beforeSend: function (xhr){
								xhr.setRequestHeader('Authorization', 'Basic ' + btoa(user + ":" + password));
							}
						},
						function(data, status) {
							var groups = $('#groups');
							$.each(
								data,
								function(i, field) {
									groups.append(createGroupListItem(field));
									console.log(field);
								}
							);

							groups.listview('refresh');
						}
					);
				}
			);
		</script>
	</head>
	<body>
		<div data-role="page">
			<div data-role="header">
				<h1>LR Image Gallery</h1>
			</div>

			<div role="main" class="ui-content">
				<ul data-inset="true" data-role="listview" id="groups">
				</ul>
			</div>

			<div data-role="footer">
				<h4>Footer</h4>
			</div>
		</div>
	</body>
</html>